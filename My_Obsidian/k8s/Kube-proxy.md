$\text{kube-proxy}$ ‚Äî —ç—Ç–æ –æ–¥–∏–Ω –∏–∑ —Å–∞–º—ã—Ö –≤–∞–∂–Ω—ã—Ö, –Ω–æ —á–∞—Å—Ç–æ –Ω–µ–¥–æ–æ—Ü–µ–Ω–µ–Ω–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ Worker Node, –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –∑–∞ —Ä–∞–±–æ—Ç—É –æ–±—ä–µ–∫—Ç–∞ **Service**.
https://kubernetes.io/docs/reference/command-line-tools-reference/kube-proxy/
---

## ‚öôÔ∏è –†–æ–ª—å Kube-Proxy –∏ —Ä–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç—ã

**$\text{kube-proxy}$** ‚Äî —ç—Ç–æ —Å–µ—Ç–µ–≤–æ–π –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –∫–∞–∂–¥–æ–º —É–∑–ª–µ –∫–ª–∞—Å—Ç–µ—Ä–∞. –ï–≥–æ –æ—Å–Ω–æ–≤–Ω–∞—è –∑–∞–¥–∞—á–∞ ‚Äî —Å–ª–µ–¥–∏—Ç—å –∑–∞ $\text{kube-apiserver}$ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç —Å–æ–∑–¥–∞–Ω–∏—è –∏–ª–∏ —É–¥–∞–ª–µ–Ω–∏—è $\text{Service}$'–æ–≤ –∏ **–æ–±–µ—Å–ø–µ—á–∏–≤–∞—Ç—å —Å–µ—Ç–µ–≤—É—é –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å** —ç—Ç–∏—Ö $\text{Service}$'–æ–≤.[]()

–û–Ω –¥–µ–ª–∞–µ—Ç —ç—Ç–æ, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—è –ø—Ä–∞–≤–∏–ª–∞ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞ –æ—Ç $\text{Service IP}$ –Ω–∞ $\text{IP}$-–∞–¥—Ä–µ—Å–∞ —Ü–µ–ª–µ–≤—ã—Ö $\text{Pod}$'–æ–≤.

### –¢—Ä–∏ —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã Kube-Proxy

$\text{kube-proxy}$ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏ —Ä–∞–±–æ—Ç–∞–ª –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ä–µ–∂–∏–º–∞—Ö, –Ω–æ –¥–≤–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –¥–æ–ª–∂–Ω—ã –∑–Ω–∞—Ç—å, —ç—Ç–æ $\text{iptables}$ –∏ $\text{IPVS}$.

#### 1. üìú –†–µ–∂–∏–º iptables (–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–π)

- **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:** $\text{kube-proxy}$ —Å–æ–∑–¥–∞–µ—Ç –±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∞–≤–∏–ª –≤ —Å–∏—Å—Ç–µ–º–Ω–æ–º –±—Ä–∞–Ω–¥–º–∞—É—ç—Ä–µ Linux (**$\text{iptables}$**). –≠—Ç–∏ –ø—Ä–∞–≤–∏–ª–∞ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—é—Ç —Ç—Ä–∞—Ñ–∏–∫, –∞–¥—Ä–µ—Å–æ–≤–∞–Ω–Ω—ã–π $\text{ClusterIP}$ $\text{Service}$, –∏ —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º (Round Robin) –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—é—Ç –µ–≥–æ –Ω–∞ –æ–¥–∏–Ω –∏–∑ $\text{Pod}$'–æ–≤, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —ç—Ç–æ–º—É $\text{Service}$.
    
- **–ù–µ–¥–æ—Å—Ç–∞—Ç–æ–∫:** –ü—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ $\text{Service}$'–æ–≤ –∏ $\text{Pod}$'–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç—ã—Å—è—á–∏) –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∞–≤–∏–ª $\text{iptables}$ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –æ–≥—Ä–æ–º–Ω—ã–º. –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ **–≤—ã—Å–æ–∫–æ–π –∑–∞–¥–µ—Ä–∂–∫–µ** –ø—Ä–∏ –∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏, —á—Ç–æ –∑–∞–º–µ–¥–ª—è–µ—Ç —Ä–∞–±–æ—Ç—É —Å–µ—Ç–∏ –∏ —É—Å–ª–æ–∂–Ω—è–µ—Ç –æ—Ç–ª–∞–¥–∫—É.
    

#### 2. ‚ö° –†–µ–∂–∏–º IPVS (–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç)

- **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:** **$\text{IPVS}$** ($\text{IP Virtual Server}$) ‚Äî —ç—Ç–æ –ø–æ–¥—Å–∏—Å—Ç–µ–º–∞ —è–¥—Ä–∞ Linux, –∫–æ—Ç–æ—Ä–∞—è –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—É—é –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ $\text{L4}$. $\text{kube-proxy}$ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç $\text{IPVS}$ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–∞–≤–∏–ª, –∫–æ—Ç–æ—Ä—ã–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è—é—Ç —Ç—Ä–∞—Ñ–∏–∫.
    
- **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:** $\text{IPVS}$ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ —è–¥—Ä–∞, –∏—Å–ø–æ–ª—å–∑—É—è —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ö–µ—à-—Ç–∞–±–ª–∏—Ü. –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç **–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –º–µ–Ω—å—à—É—é –∑–∞–¥–µ—Ä–∂–∫—É** –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –ø—Ä–∞–≤–∏–ª, –æ—Å–æ–±–µ–Ω–Ω–æ –≤ –∫–ª–∞—Å—Ç–µ—Ä–∞—Ö —Å —Ç—ã—Å—è—á–∞–º–∏ $\text{Service}$'–æ–≤. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, $\text{IPVS}$ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –±–æ–ª–µ–µ **—Å–ª–æ–∂–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏** (–Ω–∞–ø—Ä–∏–º–µ—Ä, $\text{least connection}$) –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç –ø—Ä–æ—Å—Ç–æ–≥–æ —Å–ª—É—á–∞–π–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞ –≤ $\text{iptables}$.
    
- **–°—Ç–∞—Ç—É—Å:** **$\text{IPVS}$ —è–≤–ª—è–µ—Ç—Å—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º** –∏ –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω—ã–º —Ä–µ–∂–∏–º–æ–º –¥–ª—è –≤—ã—Å–æ–∫–æ–Ω–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∏ –±–æ–ª—å—à–∏—Ö –ø—Ä–æ–¥–∞–∫—à–Ω-–∫–ª–∞—Å—Ç–µ—Ä–æ–≤.
    

---

## üí° –†–µ–∑—é–º–µ –¥–ª—è –°–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è

–ù–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–∏ Senior-—É—Ä–æ–≤–Ω—è –≤–∞–∂–Ω–æ –Ω–µ –ø—Ä–æ—Å—Ç–æ –Ω–∞–∑–≤–∞—Ç—å —Ä–µ–∂–∏–º—ã, –Ω–æ –∏ –æ–±—ä—è—Å–Ω–∏—Ç—å, **–ø–æ—á–µ–º—É $\text{IPVS}$ –ª—É—á—à–µ**:

> "Service —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é $\text{kube-proxy}$, –∫–æ—Ç–æ—Ä—ã–π —Å–ª–µ–¥–∏—Ç –∑–∞ $\text{apiserver}$ –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Å–µ—Ç–µ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –Ω–∞ Worker Nodes. –û—Å–Ω–æ–≤–Ω—ã—Ö —Ä–µ–∂–∏–º–∞ –¥–≤–∞: **$\text{iptables}$** (—Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–π, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ –ª–∏–Ω–µ–π–Ω–æ–º –ø–æ–∏—Å–∫–µ –ø—Ä–∞–≤–∏–ª, –ø–ª–æ—Ö–æ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º—ã–π) –∏ **$\text{IPVS}$** (—Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –Ω–∞ —è–¥—Ä–µ –∏ —Ö–µ—à-—Ç–∞–±–ª–∏—Ü–∞—Ö, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏–π –ª—É—á—à—É—é –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –∏ –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä—É—é –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É –Ω–∞–≥—Ä—É–∑–∫–∏ –¥–ª—è –±–æ–ª—å—à–∏—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤)."